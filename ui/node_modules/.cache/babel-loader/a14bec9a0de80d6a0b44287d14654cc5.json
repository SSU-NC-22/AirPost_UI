{"ast":null,"code":"var _jsxFileName = \"/home/seungmin/ncgo/ui/src/CMap.tsx\";\nimport React, { Component } from 'react';\nimport './ManagementComponents/NodeMap.css';\nimport { NODE_URL } from './defineUrl'; // ���� : https://apis.map.kakao.com/web/sample/multipleMarkerEvent/\n\nclass NodeMap extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      nodeList: [],\n      map: {},\n      left: 126.93120847993194,\n      right: 126.9814068917757,\n      up: 37.504736714448086,\n      down: 37.48669801512536\n    };\n\n    this.componentDidMount = () => {\n      var mapContainer = document.getElementById('node_map'); // ������ ǥ���� div\n\n      var mapOption = {\n        center: new window.kakao.maps.LatLng(37.49575158172499, 126.95633291769067),\n        // ������ �߽���ǥ\n        level: 3 // ������ Ȯ�� ����\n\n      }; // ������ �����մϴ�\n\n      var map = new window.kakao.maps.Map(mapContainer, mapOption);\n      mapContainer.style.height = '800px';\n      mapContainer.style.width = ' 1200px';\n      map.relayout();\n      this.setState({\n        map: map\n      });\n      this.getnodeList(this.state.left, this.state.right, this.state.up, this.state.down); // �巡�װ� ���� �� or Ȯ�� ������ ����Ǹ�\n\n      window.kakao.maps.event.addListener(map, 'idle', () => {\n        // ������ ���� ������ ���ɴϴ�\n        var bounds = map.getBounds(); // ������ ������ ��ǥ�� ���ɴϴ�\n\n        var swLatLng = bounds.getSouthWest(); // ������ �ϵ��� ��ǥ�� ���ɴϴ�\n\n        var neLatLng = bounds.getNorthEast();\n        this.setState({\n          left: swLatLng.getLng(),\n          // left\n          right: neLatLng.getLng(),\n          // right\n          up: neLatLng.getLat(),\n          // up\n          down: swLatLng.getLat() // down\n\n        });\n        this.getnodeList(swLatLng.getLng(), // left\n        neLatLng.getLng(), // right\n        neLatLng.getLat(), // up\n        swLatLng.getLat() // down\n        );\n      });\n    };\n  }\n\n  // Get node list from backend\n  getnodeList(left, right, up, down) {\n    var url = NODE_URL + '?left=' + left + '&right=' + right + '&up=' + up + '&down=' + down;\n    fetch(url).then(res => res.json()).then(data => this.setState({\n      nodeList: data\n    })).catch(error => console.error('Error:', error));\n  } // Make Marker\n\n\n  displayMarker(position, map) {\n    // ��Ŀ�� �����մϴ�\n\n    /*var marker = new window.kakao.maps.Marker({\r\n    \tmap: map, // ��Ŀ�� ǥ���� ����\r\n    \tposition: position.latlng, // ��Ŀ�� ��ġ\r\n    });*/\n    var marker = this.addMarker(position, map); // ��Ŀ�� ǥ���� custom overlay�� �����մϴ�\n\n    var customOverlay = new window.kakao.maps.CustomOverlay({\n      position: marker.getPosition()\n    });\n    var content = document.createElement('div');\n    var title = document.createElement('div');\n    title.innerHTML = 'a';\n    title.className = 'title';\n    var closeBtn = document.createElement('button');\n\n    closeBtn.onclick = function () {\n      customOverlay.setMap(null);\n    };\n\n    closeBtn.className = 'close';\n    closeBtn.type = 'button';\n    title.appendChild(closeBtn);\n    var body = document.createElement('div');\n    var bodytextAv = document.createElement('div');\n    var bodytextBa = document.createElement('div');\n    bodytextAv.appendChild(document.createTextNode('Available: O'));\n    bodytextBa.appendChild(document.createTextNode('Battery: 77%'));\n    body.insertAdjacentElement('beforeend', bodytextAv);\n    body.insertAdjacentElement('beforeend', bodytextBa);\n    var bodyElem = document.createElement('button');\n    bodyElem.className = 'btn';\n    bodyElem.setAttribute('style', 'background: #82CAFA; color : white; margin: 0 0 0 130px');\n    bodyElem.appendChild(document.createTextNode('Register Delivery'));\n    body.insertAdjacentElement('beforeend', bodyElem);\n    body.className = 'body';\n    body.setAttribute('style', 'margin: 7px 0 0 0');\n    var info = document.createElement('div');\n    info.className = 'info';\n    info.insertAdjacentElement('afterbegin', title);\n    var wrap = document.createElement('div');\n    wrap.className = 'wrap';\n    wrap.insertAdjacentElement('afterbegin', info);\n    closeBtn.insertAdjacentElement('afterend', body);\n    content.insertAdjacentElement('afterbegin', wrap);\n    customOverlay.setContent(content);\n    window.kakao.maps.event.addListener(marker, 'click', function () {\n      customOverlay.setMap(map);\n    });\n  } // ��Ŀ �̹��� �� ũ�� ���� \n  // ��� ������ ���� ���� �� ��Ŀ�̹��� �ٸ��� ǥ��\n\n\n  addMarker(position, map) {\n    if (position.kind === 'drone') var imageSrc = 'https://user-images.githubusercontent.com/68888653/126869406-4d22668f-04df-44e2-a952-6c4f7f9bc15d.png';else if (position.kind === 'station') var imageSrc = 'https://user-images.githubusercontent.com/68888653/126869445-228df4e6-6496-4597-b12e-7a0dd11a12d8.png';else var imageSrc = 'https://user-images.githubusercontent.com/68888653/126869406-4d22668f-04df-44e2-a952-6c4f7f9bc15d.png';\n    var imageSize = new window.kakao.maps.Size(30, 35),\n        markerImage = new window.kakao.maps.MarkerImage(imageSrc, imageSize),\n        //markerImage = new window.kakao.maps.MarkerImage(imageSrc, imageSize, imgOptions),\n    marker = new window.kakao.maps.Marker({\n      map: map,\n      position: position.latlng,\n      // ��Ŀ�� ��ġ\n      image: markerImage\n    }); // marker.setMap(map); // ���� ���� ��Ŀ�� ǥ���մϴ�\n\n    return marker;\n  }\n\n  render() {\n    var positions = this.state.nodeList.map(node => {\n      return {\n        title: node.name.split('-')[1] + '-' + node.name.split('-')[2],\n        kind: node.name.split('-')[0],\n        content: ['sink : ' + node.sink_id, 'id : ' + node.id, 'sensor : ' + node.sensors.map(sensor => sensor.value_name + ', ')],\n        latlng: new window.kakao.maps.LatLng(node.lat, node.lng)\n      };\n    });\n\n    for (var i = 0; i < positions.length; i++) {\n      this.displayMarker(positions[i], this.state.map);\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"node_map\",\n      style: {\n        width: '100%',\n        height: '500px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 6\n      }\n    })));\n  }\n\n}\n\nexport default NodeMap;","map":{"version":3,"sources":["/home/seungmin/ncgo/ui/src/CMap.tsx"],"names":["React","Component","NODE_URL","NodeMap","state","nodeList","map","left","right","up","down","componentDidMount","mapContainer","document","getElementById","mapOption","center","window","kakao","maps","LatLng","level","Map","style","height","width","relayout","setState","getnodeList","event","addListener","bounds","getBounds","swLatLng","getSouthWest","neLatLng","getNorthEast","getLng","getLat","url","fetch","then","res","json","data","catch","error","console","displayMarker","position","marker","addMarker","customOverlay","CustomOverlay","getPosition","content","createElement","title","innerHTML","className","closeBtn","onclick","setMap","type","appendChild","body","bodytextAv","bodytextBa","createTextNode","insertAdjacentElement","bodyElem","setAttribute","info","wrap","setContent","kind","imageSrc","imageSize","Size","markerImage","MarkerImage","Marker","latlng","image","render","positions","node","name","split","sink_id","id","sensors","sensor","value_name","lat","lng","i","length"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport './ManagementComponents/NodeMap.css';\r\nimport { NODE_URL } from './defineUrl';\r\n\r\n// ���� : https://apis.map.kakao.com/web/sample/multipleMarkerEvent/\r\n\r\nimport {\r\n\tnodeListElem,\r\n\tvalue_list_elem,\r\n\tsensorListElem,\r\n\tnodeHealthCheckElem,\r\n} from './ElemInterface/ElementsInterface';\r\n\r\ndeclare global {\r\n\tinterface Window {\r\n\t\tkakao: any;\r\n\t}\r\n}\r\n\r\ninterface NodeMapProps {\r\n\thealthState: Map<number, number>;\r\n\tbatteryState: Map<number, number>;\r\n}\r\n\r\ninterface NodeMapState {\r\n\tnodeList: Array<nodeListElem>;\r\n\tmap: any;\r\n\tleft: number;\r\n\tright: number;\r\n\tup: number;\r\n\tdown: number;\r\n}\r\n\r\nclass NodeMap extends Component<NodeMapProps, NodeMapState> {\r\n\tstate: NodeMapState = {\r\n\t\tnodeList: [],\r\n\t\tmap: {},\r\n\t\tleft: 126.93120847993194,\r\n\t\tright: 126.9814068917757,\r\n\t\tup: 37.504736714448086,\r\n\t\tdown: 37.48669801512536,\r\n\t};\r\n\tcomponentDidMount = () => {\r\n\t\tvar mapContainer = document.getElementById('node_map'); // ������ ǥ���� div\r\n\t\tvar mapOption = {\r\n\t\t\tcenter: new window.kakao.maps.LatLng(\r\n\t\t\t\t37.49575158172499,\r\n\t\t\t\t126.95633291769067\r\n\t\t\t), // ������ �߽���ǥ\r\n\t\t\tlevel: 3, // ������ Ȯ�� ����\r\n\t\t};\r\n\r\n\t\t// ������ �����մϴ�\r\n\t\tvar map = new window.kakao.maps.Map(mapContainer, mapOption);\r\n\t\tmapContainer!.style.height = '800px';\r\n\t\tmapContainer!.style.width = ' 1200px';\r\n\t\tmap.relayout();\r\n\t\tthis.setState({ map: map });\r\n\r\n\t\tthis.getnodeList(\r\n\t\t\tthis.state.left,\r\n\t\t\tthis.state.right,\r\n\t\t\tthis.state.up,\r\n\t\t\tthis.state.down,\r\n\t\t);\r\n\r\n\t\t// �巡�װ� ���� �� or Ȯ�� ������ ����Ǹ�\r\n\t\twindow.kakao.maps.event.addListener(map, 'idle', () => {\r\n\t\t\t// ������ ���� ������ ���ɴϴ�\r\n\t\t\tvar bounds = map.getBounds();\r\n\r\n\t\t\t// ������ ������ ��ǥ�� ���ɴϴ�\r\n\t\t\tvar swLatLng = bounds.getSouthWest();\r\n\r\n\t\t\t// ������ �ϵ��� ��ǥ�� ���ɴϴ�\r\n\t\t\tvar neLatLng = bounds.getNorthEast();\r\n\r\n\t\t\tthis.setState({\r\n\t\t\t\tleft: swLatLng.getLng(), // left\r\n\t\t\t\tright: neLatLng.getLng(), // right\r\n\t\t\t\tup: neLatLng.getLat(), // up\r\n\t\t\t\tdown: swLatLng.getLat(), // down\r\n\t\t\t});\r\n\r\n\t\t\tthis.getnodeList(\r\n\t\t\t\tswLatLng.getLng(), // left\r\n\t\t\t\tneLatLng.getLng(), // right\r\n\t\t\t\tneLatLng.getLat(), // up\r\n\t\t\t\tswLatLng.getLat() // down\r\n\t\t\t);\r\n\t\t});\r\n\t};\r\n\t// Get node list from backend\r\n\tgetnodeList(left: number, right: number, up: number, down: number) {\r\n\t\tvar url =\r\n\t\t\tNODE_URL +\r\n\t\t\t'?left=' +\r\n\t\t\tleft +\r\n\t\t\t'&right=' +\r\n\t\t\tright +\r\n\t\t\t'&up=' +\r\n\t\t\tup +\r\n\t\t\t'&down=' +\r\n\t\t\tdown;\r\n\t\tfetch(url)\r\n\t\t\t.then((res) => res.json())\r\n\t\t\t.then((data) => this.setState({ nodeList: data }))\r\n\t\t\t.catch((error) => console.error('Error:', error));\r\n\t}\r\n\r\n\t// Make Marker\r\n\tdisplayMarker(position: any, map: any) {\r\n\t\t// ��Ŀ�� �����մϴ�\r\n\t\t/*var marker = new window.kakao.maps.Marker({\r\n\t\t\tmap: map, // ��Ŀ�� ǥ���� ����\r\n\t\t\tposition: position.latlng, // ��Ŀ�� ��ġ\r\n\t\t});*/\r\n\r\n\t\tvar marker = this.addMarker(position, map)\r\n\r\n\t\t// ��Ŀ�� ǥ���� custom overlay�� �����մϴ�\r\n\t\tvar customOverlay = new window.kakao.maps.CustomOverlay({\r\n\t\t\tposition: marker.getPosition(),\r\n\t\t});\r\n\r\n\t\tvar content = document.createElement('div');\r\n\t\t\r\n\t\tvar title = document.createElement('div');\r\n\t\ttitle.innerHTML = 'a';\r\n\t\ttitle.className = 'title';\r\n\t\t\r\n\t\tvar closeBtn = document.createElement('button');\r\n\r\n\t\tcloseBtn.onclick = function () {\r\n\t\t\tcustomOverlay.setMap(null);\r\n\t\t};\r\n\t\tcloseBtn.className = 'close';\r\n\t\tcloseBtn.type = 'button';\r\n\t\t\r\n\t\ttitle.appendChild(closeBtn);\r\n\t\t\r\n\t\tvar body = document.createElement('div');\r\n\t\tvar bodytextAv = document.createElement('div');\r\n\t\tvar bodytextBa = document.createElement('div');\r\n\t\tbodytextAv.appendChild(document.createTextNode('Available: O'));\r\n\t\tbodytextBa.appendChild(document.createTextNode('Battery: 77%'));\r\n\t\tbody.insertAdjacentElement('beforeend', bodytextAv);\r\n\t\tbody.insertAdjacentElement('beforeend', bodytextBa);\r\n\r\n\t\tvar bodyElem = document.createElement('button');\r\n\t\tbodyElem.className = 'btn'\r\n\t\tbodyElem.setAttribute('style', 'background: #82CAFA; color : white; margin: 0 0 0 130px');\r\n\t\tbodyElem.appendChild(document.createTextNode('Register Delivery'));\r\n\t\tbody.insertAdjacentElement('beforeend', bodyElem);\r\n\r\n\t\tbody.className = 'body';\r\n\t\tbody.setAttribute('style', 'margin: 7px 0 0 0');\r\n\r\n\t\tvar info = document.createElement('div');\r\n\t\tinfo.className = 'info';\r\n\t\t\r\n\t\tinfo.insertAdjacentElement('afterbegin', title);\r\n\t\t\r\n\t\tvar wrap = document.createElement('div');\r\n\t\twrap.className = 'wrap';\r\n\t\t\r\n\t\twrap.insertAdjacentElement('afterbegin', info);\r\n\t\t\r\n\t\tcloseBtn.insertAdjacentElement('afterend', body);\r\n\t\t\r\n\t\tcontent.insertAdjacentElement('afterbegin', wrap);\r\n\r\n\t\tcustomOverlay.setContent(content);\r\n\r\n\t\twindow.kakao.maps.event.addListener(marker, 'click', function () {\r\n\t\t\tcustomOverlay.setMap(map);\r\n\t\t});\r\n\t}\r\n\r\n\t// ��Ŀ �̹��� �� ũ�� ���� \r\n\t// ��� ������ ���� ���� �� ��Ŀ�̹��� �ٸ��� ǥ��\r\n\taddMarker(position: any, map: any) {\r\n\t\tif ( position.kind  === 'drone') var imageSrc = 'https://user-images.githubusercontent.com/68888653/126869406-4d22668f-04df-44e2-a952-6c4f7f9bc15d.png'\r\n\t\telse if ( position.kind === 'station') var imageSrc = 'https://user-images.githubusercontent.com/68888653/126869445-228df4e6-6496-4597-b12e-7a0dd11a12d8.png'\r\n\t\telse var imageSrc = 'https://user-images.githubusercontent.com/68888653/126869406-4d22668f-04df-44e2-a952-6c4f7f9bc15d.png'\r\n\t\t\r\n\t\tvar imageSize = new window.kakao.maps.Size(30 , 35),\r\n\t\t\tmarkerImage = new window.kakao.maps.MarkerImage(imageSrc, imageSize),\r\n\t\t\t//markerImage = new window.kakao.maps.MarkerImage(imageSrc, imageSize, imgOptions),\r\n\t\t\t\tmarker = new window.kakao.maps.Marker({\r\n\t\t\t\tmap: map,\r\n\t\t\t\tposition: position.latlng, // ��Ŀ�� ��ġ\r\n\t\t\t\timage: markerImage \r\n\t\t\t});\r\n\r\n\t\t// marker.setMap(map); // ���� ���� ��Ŀ�� ǥ���մϴ�\r\n\t\r\n\t\treturn marker;\r\n\t}\r\n\r\n\trender() {\r\n\t\tvar positions = this.state.nodeList.map((node: nodeListElem) => {\r\n\t\t\treturn {\r\n\t\t\t\ttitle: node.name.split('-')[1] + '-' + node.name.split('-')[2],\r\n\t\t\t\tkind: node.name.split('-')[0],\r\n\t\t\t\tcontent: [\r\n\t\t\t\t\t'sink : ' + node.sink_id,\r\n\t\t\t\t\t'id : ' + node.id,\r\n\t\t\t\t\t'sensor : ' +\r\n\t\t\t\t\t\tnode.sensors.map((sensor: value_list_elem) => sensor.value_name+', '),\r\n\t\t\t\t],\r\n\t\t\t\tlatlng: new window.kakao.maps.LatLng(node.lat, node.lng),\r\n\t\t\t};\r\n\t\t});\r\n\r\n\t\tfor (var i = 0; i < positions.length; i++) {\r\n\t\t\tthis.displayMarker(positions[i], this.state.map);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<div id=\"node_map\" style={{ width: '100%', height: '500px' }}></div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default NodeMap;"]},"metadata":{},"sourceType":"module"}